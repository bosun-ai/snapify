<link rel="stylesheet" href="{{ 'component-slider.css' | asset_url }}" media="print" onload="this.media='all'">
<noscript>{{ 'component-slider.css' | asset_url | stylesheet_tag }}</noscript>
{% style %}
.section-{{ section.id }}-padding {
  padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
  padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
}
#shopify-section-{{ section.id }} {
  margin-top: 0;
}
        :root {
          --bg: #fafafa;
          --text: #2a2f36;
          --muted: #6b7480;
          --accent: #2255ff;
          --card: #ffffff;
          --shadow: 0 6px 24px rgba(0,0,0,0.05);
          --radius: 18px;
          --divider: #d0d4da;
        }
    
        body {
          margin: 0;
          font-family: "Inter", "Helvetica Neue", Arial, sans-serif;
          background: var(--bg);
          color: var(--text);
          line-height: 1.6;
        }
    
        .wrap {
          display: grid;
          place-items: center;
          min-height: 100dvh;
          padding: 2rem;
        }
    
        .testimonial {
          display: grid;
          grid-template-columns: 88px 1fr;
          gap: 24px;
          align-items: start;
          max-width: 950px;
          background: var(--card);
          border-radius: var(--radius);
          box-shadow: var(--shadow);
          padding: 40px;
        }
    
        .avatar {
          width: 88px;
          height: 88px;
          border-radius: 50%;
          object-fit: cover;
        }
    
        /* === Tag style === */
        .tag {
          display: inline-block;
          background: rgba(34,85,255,0.08);
          color: var(--accent);
          font-size: 12px;
          font-weight: 600;
          padding: 4px 12px;
          border-radius: 999px;
          letter-spacing: 0.3px;
          margin-bottom: 18px;
        }
    
        blockquote {
          margin: 0;
          font-size: 15px;
          color: var(--text);
          font-weight: 400;
          position: relative;
          padding: 0 40px;
          font-style: normal;
        }
    
        blockquote::before,
        blockquote::after {
          position: absolute;
          color: var(--accent);
          font-family: Georgia, serif;
          font-size: 40px;
          line-height: 1;
        }
    
        blockquote::before {
          content: "“";
          top: -10px;
          left: 0;
        }
    
        blockquote::after {
          content: "”";
          bottom: -35px;
          right: 0;
        }
    
        .meta {
          margin-top: 18px;
          display: flex;
          align-items: center;
          gap: 16px;
          flex-wrap: wrap;
        }
    
        .person {
          display: grid;
          gap: 2px;
        }
    
        .name {
          font-weight: 700;
          font-size: 14px;
          letter-spacing: 0.2px;
          color: #2a2f36;
        }
    
        .titleTestimonial {
          font-size: 13px;
          color: var(--muted);
          margin: 0;
        }
    
        /* Divider between person and logo */
        .divider {
          width: 3px;
          height: 64px;
          background: var(--divider);
          align-self: center;
          margin: 0 4px;
        }
    
        /* Left-aligned logo + company name */
        .logo-wrapper {
          display: flex;
          flex-direction: column;
          align-items: flex-start;
          gap: 4px;
        }
    
        .logo {
          height: 28px;
          width: auto;
          display: block;
        }
    
        .company-name {
          font-size: 12px;
          color: var(--muted);
          text-align: left;
          line-height: 1.3;
        }
        .company-name p {
          margin: 0;
        }

        
  .left-top-triangle {
    width: 0;
    height: 0;
    border-style: solid;
    border-width: calc(100vw/8) calc(100vw/6.5) 0 0;
    border-color: #2255ff transparent transparent transparent;
    position: absolute;
    top: 0;
    left: 0;
    z-index: 1; /* Ensure the triangle appears above other content if needed */
    display: block !important;
  }
  .right-top-triangle {
    width: 0;
    height: 0;
    border-style: solid;
   border-width: 0 calc(100vw/6.5) calc(100vw/8) 0;
    border-color: transparent #2255ff transparent transparent;
    position: absolute;
    top: 0;
    right: 0;
    z-index: 1; /* Ensure the triangle appears above other content if needed */
    display: block !important;
  }
  .left-bottom-triangle {
    width: 0;
    height: 0;
    border-style: solid;
    border-width: calc(100vw/8) 0 0 calc(100vw/6.5);
    border-color: transparent transparent transparent #2255ff;
    position: absolute;
    bottom: 0;
    left: 0;
    z-index: 1; /* Ensure the triangle appears above other content if needed */
    display: block !important;
  }
  .right-bottom-triangle {
    width: 0;
    height: 0;
    border-style: solid;
    border-width: 0 0 calc(100vw/8) calc(100vw/6.5);
    border-color: transparent transparent #2255ff transparent;
    position: absolute;
    bottom: 0;
    right: 0;
    z-index: 1; /* Ensure the triangle appears above other content if needed */
    display: block !important;
  }
    
        @media (max-width: 600px) {
          .testimonial {
            grid-template-columns: 1fr;
            padding: 28px;
          }
          blockquote {
            font-size: 11px;
            padding: 10px 0px;
          }
          blockquote::before,
          blockquote::after {
            font-size: 32px;
          }
          .divider {
            display: none;
          }
        /* Remove left margin on mobile */
        .meta {
          margin-left: 0 !important;
        }
        }
{% endstyle %}
<div style="position: relative;">
  <div class="section-{{ section.id }}-padding page-width">
    {% if section.settings.bluecorner_upper_left %}
      <div class="left-top-triangle"></div>
    {% endif %}
    {% if section.settings.bluecorner_upper_right %}
      <div class="right-top-triangle"></div>
    {% endif %}
    {% if section.settings.bluecorner_lower_left %}
      <div class="left-bottom-triangle"></div>
    {% endif %}
    {% if section.settings.bluecorner_lower_right %}
      <div class="right-bottom-triangle"></div>
    {% endif %}
    <div>
      {% if section.settings.title != blank %}
        <h2 style="text-align: left;margin: 0;" class="title h1">{{ section.settings.title }}</h2>
      {% endif %}
      <div class="slider-mobile-gutter">
          {%- for block in section.blocks -%}
              <figure class="testimonial" id="testimonial-{{ forloop.index0 }}" style="display: {% if forloop.index0 == 0 %}grid{% else %}none{% endif %};">
                  <img src="{{ block.settings.avatar | image_url: width: 100 }}" alt="{{ block.settings.avatar.alt | escape }}" class="avatar" />
              
                  <div>
                      <!-- NEW TAG ABOVE THE QUOTE -->
                      <div class="tag">{{ block.settings.tag }}</div>
              
                      <div>
                          <blockquote style="border: 0;">
                          {{ block.settings.testimonial }}
                          </blockquote>
                  
                          <figcaption class="meta" style="padding-left: 40px">
                          <div class="person">
                              <span class="name">{{ block.settings.name }}</span>
                              <span class="titleTestimonial">{{ block.settings.title }}</span>
                          </div>
                  
                          <div class="divider" aria-hidden="true" style="display: block!important;"></div>
                  
                          <div class="logo-wrapper">
                              <img src="{{ block.settings.logo | image_url: width: 100 }}" alt="{{ block.settings.logo.alt | escape }}" class="logo" />
                              <span class="company-name">{{ block.settings.company_name }}</span>
                          </div>
                          </figcaption>
                      </div>
                  </div>
              </figure>
          {%- endfor -%}
      {%- if section.blocks.size > 1 -%}
          <div class="slider-buttons no-js-hidden medium-hide">
              <button type="button" class="slider-button slider-button--prev" name="previous" aria-label="{{ 'general.slider.previous_slide' | t }}" style="transform: rotate(90deg);">{% render 'icon-caret' %}</button>
              <div class="slider-counter caption">
              <span class="slider-counter--current">1</span>
              <span aria-hidden="true"> / </span>
              <span class="visually-hidden">{{ 'general.slider.of' | t }}</span>
              <span class="slider-counter--total">{{ section.blocks.size }}</span>
              </div>
              <button type="button" class="slider-button slider-button--next" name="next" aria-label="{{ 'general.slider.next_slide' | t }}" style="transform: rotate(270deg);">{% render 'icon-caret' %}</button>
          </div>
          {%- endif -%}
      </div>
    </div>
  </div>
</div>
<script>
    currentPage = 0;
    const totalPages = {{ section.blocks.size }};
    let slideInterval = null;
    const autoSlideDelay = 5000; // Auto-slide every 5 seconds (adjust as needed)
    let isAutoSliding = false; // Flag to prevent reset when auto-sliding

    function startAutoSlide() {
        // Clear any existing interval
        if (slideInterval) {
            clearInterval(slideInterval);
        }
        // Start auto-sliding
        isAutoSliding = true;
        slideInterval = setInterval(function() {
            isAutoSliding = true;
            nextSlide();
            isAutoSliding = false;
        }, autoSlideDelay);
    }

    function stopAutoSlide() {
        if (slideInterval) {
            clearInterval(slideInterval);
            slideInterval = null;
        }
    }

    function resetAutoSlide() {
        stopAutoSlide();
        // Restart after a short delay
        setTimeout(startAutoSlide, autoSlideDelay);
    }

    function nextSlide() {
        nextpage = currentPage + 1;
        if (nextpage >= totalPages) {
            nextpage = 0;
        }
        document.getElementById('testimonial-' + (currentPage)).style.display = 'none';
        document.getElementById('testimonial-' + nextpage).style.display = 'grid';
        currentPage = nextpage;
        document.querySelector('.slider-counter--current').textContent = nextpage + 1;
        
        // Reset auto-slide timer if manually triggered
        if (!isAutoSliding && totalPages > 1) {
            resetAutoSlide();
        }
    }
    
    function prevSlide() {
        prevpage = currentPage - 1;
        if (prevpage < 0) {
            prevpage = totalPages - 1;
        }
        document.getElementById('testimonial-' + currentPage).style.display = 'none';
        document.getElementById('testimonial-' + prevpage).style.display = 'grid';
        document.querySelector('.slider-counter--current').textContent = prevpage + 1;
        currentPage = prevpage;
        
        // Reset auto-slide timer if manually triggered
        if (!isAutoSliding && totalPages > 1) {
            resetAutoSlide();
        }
    }

    document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('testimonial-' + 0).style.display = 'grid';
        if (totalPages > 1) {
            startAutoSlide();
            
            // Pause auto-slide on hover, resume on mouse leave
            const sliderContainer = document.querySelector('.slider-mobile-gutter');
            if (sliderContainer) {
                sliderContainer.addEventListener('mouseenter', stopAutoSlide);
                sliderContainer.addEventListener('mouseleave', startAutoSlide);
            }
            
            // Set up button event listeners
            const nextButton = document.querySelector('.slider-button--next');
            const prevButton = document.querySelector('.slider-button--prev');
            if (nextButton) {
                nextButton.addEventListener('click', nextSlide);
            }
            if (prevButton) {
                prevButton.addEventListener('click', prevSlide);
            }
        }
    });

</script>
{% schema %}
    {
        "name": "t:sections.testimonial.name",
        "class": "section",
        "settings": [ 
            {
                "type": "text",
                "id": "title",
                "label": "Heading"
            },
            {
                "type": "range",
                "id": "padding_top",
                "min": 0,
                "max": 200,
                "step": 4,
                "unit": "px",
                "label": "t:sections.all.padding.padding_top",
                "default": 36
            }, {
                "type": "range",
                "id": "padding_bottom",
                "min": 0,
                "max": 100,
                "step": 4,
                "unit": "px",
                "label": "t:sections.all.padding.padding_bottom",
                "default": 36
            },
            {
                "type": "checkbox",
                "id": "bluecorner_upper_left",
                "label": "Blue Corner Upper Left",
                "default": false
            },
            {
                "type": "checkbox",
                "id": "bluecorner_upper_right",
                "label": "Blue Corner Upper Right",
                "default": false
            },
            {
                "type": "checkbox",
                "id": "bluecorner_lower_left",
                "label": "Blue Corner Lower Left",
                "default": false
            },
            {
                "type": "checkbox",
                "id": "bluecorner_lower_right",
                "label": "Blue Corner Lower Right",
                "default": false
            }
        ],
        "blocks": [
            {
                "type": "testimonial",
                "name": "Testimonial",
                "settings": [
                    {
                        "type": "image_picker",
                        "id": "avatar",
                        "label": "Avatar"
                    },
                    {
                        "type": "text",
                        "id": "tag",
                        "label": "Tag"
                    },
                    {
                        "type": "richtext",
                        "id": "testimonial",
                        "label": "Testimonial"
                    },
                    {
                        "type": "text",
                        "id": "name",
                        "label": "Name"
                    },
                    {
                        "type": "text",
                        "id": "title",
                        "label": "Title"
                    },
                    {
                        "type": "image_picker",
                        "id": "logo",
                        "label": "Logo"
                    },
                    {
                        "type": "richtext",
                        "id": "company_name",
                        "label": "Company Name"
                    }
                ]
            }
        ],
        "presets": [
            {
                "name": "t:sections.testimonial.presets.name",
                "blocks": [
                    {
                        "type": "testimonial"
                    }
                ]
            }
        ]
    }
{% endschema %}
      